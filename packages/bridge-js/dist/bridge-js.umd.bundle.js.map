{"version":3,"file":"bridge-js.umd.bundle.js","sources":["../../bridge-core/dist/types.js","../src/index.ts"],"sourcesContent":["export var EBridgeMessageType;\n(function (EBridgeMessageType) {\n    EBridgeMessageType[\"PING\"] = \"@straddleio/js-bridge/ping\";\n    EBridgeMessageType[\"ERROR\"] = \"@straddleio/js-bridge/error\";\n    EBridgeMessageType[\"INITIALIZE\"] = \"@straddleio/js-bridge/initialize\";\n    EBridgeMessageType[\"INITIALIZING\"] = \"@straddleio/js-bridge/initializing\";\n    EBridgeMessageType[\"INITIALIZED\"] = \"@straddleio/js-bridge/initialized\";\n    EBridgeMessageType[\"MOUNTED\"] = \"@straddleio/js-bridge/mounted\";\n    EBridgeMessageType[\"ON_PAYKEY\"] = \"@straddleio/js-bridge/on-wallet-token\";\n    EBridgeMessageType[\"ON_SUCCESS\"] = \"@straddleio/js-bridge/on-success\";\n    EBridgeMessageType[\"ON_SUCCESS_CTA_CLICKED\"] = \"@straddleio/js-bridge/on-success-cta-clicked\";\n    EBridgeMessageType[\"TOKEN\"] = \"@straddleio/js-bridge/token\";\n    EBridgeMessageType[\"DEBUG\"] = \"@straddleio/js-bridge/debug\";\n})(EBridgeMessageType || (EBridgeMessageType = {}));\n","import { EBridgeMessageType, TMessage } from '@straddleio/bridge-core'\n\nconst straddleBridge = {\n    getUrl: () => `${straddleBridge.origin}/${encodeURIComponent(window.location.origin)}/`,\n    origin: '',\n    mounted: false,\n    verbose: false,\n    init: function init(params: {\n        appUrl: string\n        token: string\n        onSuccess?: (payload: any) => void\n        onSuccessCTAClicked?: () => void\n        onBridgeToken?: () => void\n        style: Partial<CSSStyleDeclaration>\n        verbose?: boolean\n    }) {\n        const { appUrl, token, onSuccess, onSuccessCTAClicked, onBridgeToken, style, verbose = false } = params\n        straddleBridge.origin = appUrl ?? 'https://dev.straddle.io'\n        verbose && console.log('init called')\n        const iframe = document.createElement('iframe')\n        iframe.setAttribute('src', straddleBridge.getUrl())\n        iframe.id = 'Straddle-widget-iframe'\n        Object.assign(iframe.style, style)\n        document.getElementsByTagName('body')[0].appendChild(iframe)\n        window.addEventListener('message', function (event: MessageEvent<TMessage>) {\n            if (event.origin === straddleBridge.origin) {\n                verbose && console.log('Message received from widget:', event.data.type, event)\n                switch (event.data?.type) {\n                    case EBridgeMessageType.MOUNTED:\n                        if (!straddleBridge.mounted) {\n                            straddleBridge.mounted = true\n                            straddleBridge.send({ type: EBridgeMessageType.INITIALIZE, token })\n                        }\n                        break\n                    case EBridgeMessageType.ON_SUCCESS_CTA_CLICKED:\n                        document.getElementsByTagName('body')[0].removeChild(iframe)\n                        onSuccessCTAClicked?.()\n                        break\n                    case EBridgeMessageType.ON_PAYKEY:\n                        onSuccess?.(event.data)\n                        break\n                    case EBridgeMessageType.TOKEN:\n                        onBridgeToken?.()\n                        break\n                }\n            }\n        })\n    },\n    getIframe: () => document.getElementById('Straddle-widget-iframe') as HTMLIFrameElement,\n    show: () => {\n        straddleBridge.verbose && console.log('straddleBridge.show method called.')\n        const iframe = straddleBridge.getIframe()\n        straddleBridge.verbose && iframe && console.log('iframe found, setting display to block.')\n        iframe.style.display = 'block'\n    },\n    hide: () => {\n        straddleBridge.verbose && console.log('straddleBridge.hide method called.')\n        const iframe = straddleBridge.getIframe()\n        straddleBridge.verbose && iframe && console.log('iframe found, setting display to none.')\n        iframe.style.display = 'none'\n    },\n    remove: () => {\n        straddleBridge.verbose && console.log('straddleBridge.remove method called.')\n        const iframe = straddleBridge.getIframe()\n        iframe.remove()\n        straddleBridge.mounted = false\n    },\n    send: function send(message: TMessage) {\n        const iframe = document.getElementById('Straddle-widget-iframe') as HTMLIFrameElement\n        console.log('sending message:', message)\n        iframe?.contentWindow?.postMessage(message, straddleBridge.origin)\n    },\n}\n;(window as any).straddleBridge = straddleBridge\n\nObject.defineProperty(straddleBridge, 'debug', {\n    value: {\n        enable: () => straddleBridge.send({ type: EBridgeMessageType.DEBUG, enable: true }),\n        disable: () => straddleBridge.send({ type: EBridgeMessageType.DEBUG, enable: false }),\n    },\n    enumerable: false,\n    writable: false,\n    configurable: false,\n})\n"],"names":["EBridgeMessageType","straddleBridge","getUrl","origin","encodeURIComponent","window","location","mounted","verbose","init","params","appUrl","token","onSuccess","onSuccessCTAClicked","onBridgeToken","style","console","log","iframe","document","createElement","setAttribute","id","Object","assign","getElementsByTagName","appendChild","addEventListener","event","data","type","_a","MOUNTED","send","INITIALIZE","ON_SUCCESS_CTA_CLICKED","removeChild","ON_PAYKEY","TOKEN","getIframe","getElementById","show","display","hide","remove","message","contentWindow","postMessage","defineProperty","value","enable","DEBUG","disable","enumerable","writable","configurable"],"mappings":"2FAAO,IAAIA,GACX,SAAWA,GACPA,EAAyB,KAAI,6BAC7BA,EAA0B,MAAI,8BAC9BA,EAA+B,WAAI,mCACnCA,EAAiC,aAAI,qCACrCA,EAAgC,YAAI,oCACpCA,EAA4B,QAAI,gCAChCA,EAA8B,UAAI,wCAClCA,EAA+B,WAAI,mCACnCA,EAA2C,uBAAI,+CAC/CA,EAA0B,MAAI,8BAC9BA,EAA0B,MAAI,6BACjC,CAZD,CAYGA,IAAuBA,EAAqB,CAAA,ICX/C,MAAMC,EAAiB,CACnBC,OAAQ,IAAM,GAAGD,EAAeE,UAAUC,mBAAmBC,OAAOC,SAASH,WAC7EA,OAAQ,GACRI,SAAS,EACTC,SAAS,EACTC,KAAM,SAAcC,GAShB,MAAMC,OAAEA,EAAMC,MAAEA,EAAKC,UAAEA,EAASC,oBAAEA,EAAmBC,cAAEA,EAAaC,MAAEA,EAAKR,QAAEA,GAAU,GAAUE,EACjGT,EAAeE,OAASQ,QAAAA,EAAU,0BAClCH,GAAWS,QAAQC,IAAI,eACvB,MAAMC,EAASC,SAASC,cAAc,UACtCF,EAAOG,aAAa,MAAOrB,EAAeC,UAC1CiB,EAAOI,GAAK,yBACZC,OAAOC,OAAON,EAAOH,MAAOA,GAC5BI,SAASM,qBAAqB,QAAQ,GAAGC,YAAYR,GACrDd,OAAOuB,iBAAiB,WAAW,SAAUC,SACzC,GAAIA,EAAM1B,SAAWF,EAAeE,OAEhC,OADAK,GAAWS,QAAQC,IAAI,gCAAiCW,EAAMC,KAAKC,KAAMF,GACrD,UAAZA,EAAMC,YAAM,IAAAE,OAAA,EAAAA,EAAAD,MAChB,KAAK/B,EAAmBiC,QACfhC,EAAeM,UAChBN,EAAeM,SAAU,EACzBN,EAAeiC,KAAK,CAAEH,KAAM/B,EAAmBmC,WAAYvB,WAE/D,MACJ,KAAKZ,EAAmBoC,uBACpBhB,SAASM,qBAAqB,QAAQ,GAAGW,YAAYlB,GACrDL,SAAAA,IACA,MACJ,KAAKd,EAAmBsC,UACpBzB,SAAAA,EAAYgB,EAAMC,MAClB,MACJ,KAAK9B,EAAmBuC,MACpBxB,SAAAA,IAIhB,GACH,EACDyB,UAAW,IAAMpB,SAASqB,eAAe,0BACzCC,KAAM,KACFzC,EAAeO,SAAWS,QAAQC,IAAI,sCACtC,MAAMC,EAASlB,EAAeuC,YAC9BvC,EAAeO,SAAWW,GAAUF,QAAQC,IAAI,2CAChDC,EAAOH,MAAM2B,QAAU,OAAO,EAElCC,KAAM,KACF3C,EAAeO,SAAWS,QAAQC,IAAI,sCACtC,MAAMC,EAASlB,EAAeuC,YAC9BvC,EAAeO,SAAWW,GAAUF,QAAQC,IAAI,0CAChDC,EAAOH,MAAM2B,QAAU,MAAM,EAEjCE,OAAQ,KACJ5C,EAAeO,SAAWS,QAAQC,IAAI,wCACvBjB,EAAeuC,YACvBK,SACP5C,EAAeM,SAAU,CAAK,EAElC2B,KAAM,SAAcY,SAChB,MAAM3B,EAASC,SAASqB,eAAe,0BACvCxB,QAAQC,IAAI,mBAAoB4B,GACX,QAArBd,EAAAb,aAAA,EAAAA,EAAQ4B,qBAAa,IAAAf,GAAAA,EAAEgB,YAAYF,EAAS7C,EAAeE,OAC9D,GAEHE,OAAeJ,eAAiBA,EAElCuB,OAAOyB,eAAehD,EAAgB,QAAS,CAC3CiD,MAAO,CACHC,OAAQ,IAAMlD,EAAeiC,KAAK,CAAEH,KAAM/B,EAAmBoD,MAAOD,QAAQ,IAC5EE,QAAS,IAAMpD,EAAeiC,KAAK,CAAEH,KAAM/B,EAAmBoD,MAAOD,QAAQ,KAEjFG,YAAY,EACZC,UAAU,EACVC,cAAc"}