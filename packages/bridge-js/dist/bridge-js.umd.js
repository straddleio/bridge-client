!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@straddleio/bridge-core")):"function"==typeof define&&define.amd?define(["exports","@straddleio/bridge-core"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).StraddleBridge={},e.BridgeCore)}(this,(function(e,o){"use strict";const d={getUrl:()=>`${d.origin}/${encodeURIComponent("undefined"!=typeof window&&window.location.origin)}/`,origin:"",mounted:!1,verbose:!1,init:function(e){const{appUrl:t,token:n,onSuccess:i,onSuccessCTAClicked:s,targetRef:a,style:l,className:r,verbose:g=!1}=e;d.origin=null!=t?t:"https://dev.straddle.io",g&&console.log("init called");const c=document.createElement("iframe");c.setAttribute("src",d.getUrl()),c.id="Straddle-widget-iframe";let m=l;l||(m={position:"fixed",width:"100%",height:"100%",top:"0%",left:"0",zIndex:"2147483647"}),Object.assign(c.style,m),r&&r.split(" ").forEach((e=>{c.classList.add(e)})),(a||document.getElementsByTagName("body")[0]).appendChild(c),"undefined"!=typeof window&&window.addEventListener("message",(function(e){var t;if(e.origin===d.origin)switch(g&&console.log("Message received from widget:",e.data.type,e),null===(t=e.data)||void 0===t?void 0:t.type){case o.EBridgeMessageType.MOUNTED:d.mounted||(d.mounted=!0,d.send({type:o.EBridgeMessageType.INITIALIZE,token:n}));break;case o.EBridgeMessageType.ON_SUCCESS_CTA_CLICKED:document.getElementsByTagName("body")[0].removeChild(c),null==s||s();break;case o.EBridgeMessageType.ON_PAYKEY:null==i||i(e.data);break;case"@straddleio/bridge-js/console":alert(e.data.method);{const o=e.data.payload.map((e=>{try{return JSON.parse(e)}catch(o){return e}}));console[e.data.method].apply(console,o)}}}))},getIframe:()=>document.getElementById("Straddle-widget-iframe"),show:()=>{d.verbose&&console.log("straddleBridge.show method called.");const e=d.getIframe();d.verbose&&e&&console.log("iframe found, setting display to block."),e.style.display="block"},hide:()=>{d.verbose&&console.log("straddleBridge.hide method called.");const e=d.getIframe();d.verbose&&e&&console.log("iframe found, setting display to none."),e.style.display="none"},remove:()=>{d.verbose&&console.log("straddleBridge.remove method called.");d.getIframe().remove(),d.mounted=!1},send:function(e){var o;const t=document.getElementById("Straddle-widget-iframe");console.log("sending message:",e),null===(o=null==t?void 0:t.contentWindow)||void 0===o||o.postMessage(e,d.origin)}};"undefined"!=typeof window&&(window.straddleBridge=d),Object.defineProperty(d,"debug",{value:{enable:()=>d.send({type:o.EBridgeMessageType.DEBUG,enable:!0}),disable:()=>d.send({type:o.EBridgeMessageType.DEBUG,enable:!1})},enumerable:!1,writable:!1,configurable:!1}),e.straddleBridge=d}));
