var StraddleBridge=function(e){"use strict";function t(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var d=function e(){if(this instanceof e){var d=[null];return d.push.apply(d,arguments),new(Function.bind.apply(t,d))}return t.apply(this,arguments)};d.prototype=t.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(d,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})})),d}var d,o={};!function(e){e.PING="@straddleio/js-bridge/ping",e.ERROR="@straddleio/js-bridge/error",e.INITIALIZE="@straddleio/js-bridge/initialize",e.INITIALIZING="@straddleio/js-bridge/initializing",e.INITIALIZED="@straddleio/js-bridge/initialized",e.MOUNTED="@straddleio/js-bridge/mounted",e.ON_PAYKEY="@straddleio/js-bridge/on-wallet-token",e.ON_SUCCESS="@straddleio/js-bridge/on-success",e.ON_SUCCESS_CTA_CLICKED="@straddleio/js-bridge/on-success-cta-clicked",e.ON_CLOSE="@straddleio/js-bridge/on-close",e.ON_MANUAL_ENTRY="@straddleio/js-bridge/on-manual-entry",e.ON_RETRY="@straddleio/js-bridge/on-retry",e.TOKEN="@straddleio/js-bridge/token",e.DEBUG="@straddleio/js-bridge/debug"}(d||(d={}));var i=t(Object.freeze({__proto__:null,get EBridgeMessageType(){return d}}));e.straddleBridge=void 0;var r=i;const n={getUrl:()=>`${n.origin}/${encodeURIComponent("undefined"!=typeof window&&window.location.origin)}/`,origin:"",mounted:!1,verbose:!1,init:function(e){const{appUrl:t,token:d,onSuccess:o,onSuccessCTAClicked:i,targetRef:s,style:a,className:l,verbose:g=!1}=e;n.origin=null!=t?t:"https://dev.straddle.io",g&&console.log("init called");const c=document.createElement("iframe");c.setAttribute("src",n.getUrl()),c.id="Straddle-widget-iframe";let u=a;a||(u={position:"fixed",width:"100%",height:"100%",top:"0%",left:"0",zIndex:"2147483647"}),Object.assign(c.style,u),l&&l.split(" ").forEach((e=>{c.classList.add(e)})),(s||document.getElementsByTagName("body")[0]).appendChild(c),"undefined"!=typeof window&&window.addEventListener("message",(function(e){var t;if(e.origin===n.origin)switch(g&&console.log("Message received from widget:",e.data.type,e),null===(t=e.data)||void 0===t?void 0:t.type){case r.EBridgeMessageType.MOUNTED:n.mounted||(n.mounted=!0,n.send({type:r.EBridgeMessageType.INITIALIZE,token:d}));break;case r.EBridgeMessageType.ON_SUCCESS_CTA_CLICKED:document.getElementsByTagName("body")[0].removeChild(c),null==i||i();break;case r.EBridgeMessageType.ON_PAYKEY:null==o||o(e.data);break;case"@straddleio/bridge-js/console":alert(e.data.method);{const t=e.data.payload.map((e=>{try{return JSON.parse(e)}catch(t){return e}}));console[e.data.method].apply(console,t)}}}))},getIframe:()=>document.getElementById("Straddle-widget-iframe"),show:()=>{n.verbose&&console.log("straddleBridge.show method called.");const e=n.getIframe();n.verbose&&e&&console.log("iframe found, setting display to block."),e.style.display="block"},hide:()=>{n.verbose&&console.log("straddleBridge.hide method called.");const e=n.getIframe();n.verbose&&e&&console.log("iframe found, setting display to none."),e.style.display="none"},remove:()=>{n.verbose&&console.log("straddleBridge.remove method called."),n.getIframe().remove(),n.mounted=!1},send:function(e){var t;const d=document.getElementById("Straddle-widget-iframe");console.log("sending message:",e),null===(t=null==d?void 0:d.contentWindow)||void 0===t||t.postMessage(e,n.origin)}};return"undefined"!=typeof window&&(window.straddleBridge=n),Object.defineProperty(n,"debug",{value:{enable:()=>n.send({type:r.EBridgeMessageType.DEBUG,enable:!0}),disable:()=>n.send({type:r.EBridgeMessageType.DEBUG,enable:!1})},enumerable:!1,writable:!1,configurable:!1}),e.straddleBridge=o.straddleBridge=n,e.default=o,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
