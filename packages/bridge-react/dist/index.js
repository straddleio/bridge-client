"use strict";var e=require("@straddleio/bridge-core"),t=require("react");const d="Straddle-widget-iframe",r=({appUrl:e})=>{const[r,s]=t.useState(!1),[n,o]=t.useState(!1),i=`${e}/${a()}/`;return{send:e=>{var t;const r=document.getElementById(d);r&&(null===(t=r.contentWindow)||void 0===t||t.postMessage(e,i))},iframeMounted:r,setIframeMounted:s,bridgeAppMounted:n,setBridgeAppMounted:o,url:i}},a=()=>"undefined"!=typeof window&&encodeURIComponent(window.location.origin),s=t.forwardRef(((a,s)=>{const{appUrl:n,open:o=!0,token:i,onSuccess:l,onSuccessCTAClicked:p,className:c,style:u}=a,{send:g,iframeMounted:y,setIframeMounted:f,bridgeAppMounted:m,setBridgeAppMounted:E,url:M}=r({appUrl:n});return t.useEffect((()=>{var t;if(o&&!y){f(!0);const t=document.createElement("iframe");t.setAttribute("src",M),t.id=d;let r=u;u||(r={position:"fixed",width:"100%",height:"100%",top:"0%",left:"0",zIndex:"2147483647"}),r&&Object.assign(t.style,r),c&&c.split(" ").forEach((e=>{t.classList.add(e)})),s&&"current"in s?s.current.appendChild(t):document.getElementsByTagName("body")[0].appendChild(t),window.addEventListener("message",(function(t){var d;if(t.origin===n)switch(null===(d=t.data)||void 0===d?void 0:d.type){case e.EBridgeMessageType.PING:break;case e.EBridgeMessageType.MOUNTED:m||(E(!0),g({type:e.EBridgeMessageType.INITIALIZE,token:i}));break;case e.EBridgeMessageType.ON_SUCCESS_CTA_CLICKED:null==p||p();break;case e.EBridgeMessageType.ON_PAYKEY:null==l||l(t.data);break;case"@straddleio/bridge-js/log":{const e=t.data.payload.map((e=>{try{return JSON.parse(e)}catch(t){return e}}));console[t.data.method].apply(console,e)}}}))}else!o&&y&&(null===(t=document.querySelector(`#${d}`))||void 0===t||t.remove(),f(!1),E(!1))}),[o]),t.useEffect((()=>{"undefined"!=typeof window&&(window.debug={enable:()=>g({type:e.EBridgeMessageType.DEBUG,enable:!0}),disable:()=>g({type:e.EBridgeMessageType.DEBUG,enable:!1})})}),[]),null}));s.displayName="StraddleBridge",exports.StraddleBridge=s,exports.useStraddleBridge=r;
//# sourceMappingURL=index.js.map
